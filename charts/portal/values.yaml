###############################################################
# Copyright (c) 2021, 2023 Contributors to the Eclipse Foundation
#
# See the NOTICE file(s) distributed with this work for additional
# information regarding copyright ownership.
#
# This program and the accompanying materials are made available under the
# terms of the Apache License, Version 2.0 which is available at
# https://www.apache.org/licenses/LICENSE-2.0.
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
# License for the specific language governing permissions and limitations
# under the License.
#
# SPDX-License-Identifier: Apache-2.0
###############################################################

name: "portal"
portContainer: 8080
portService: 8080
replicaCount: 3
securityContext:
  allowPrivilegeEscalation: false
  runAsNonRoot: true
  capabilities:
    drop: ["ALL"]

frontend:
  ingress:
    enabled: false
    annotations:
      kubernetes.io/ingress.class: "nginx"
      nginx.ingress.kubernetes.io/rewrite-target: "/$1"
      nginx.ingress.kubernetes.io/use-regex: "true"
      nginx.ingress.kubernetes.io/enable-cors: "true"
      nginx.ingress.kubernetes.io/cors-allow-origin: ""
    tls:
      - secretName: ""
        hosts:
          - ""
    hosts:
      - host: ""
        paths:
          - path: "/(.*)"
            pathType: "Prefix"
            backend:
              service: "portal"
              port: 8080
          - path: "/registration/(.*)"
            pathType: "Prefix"
            backend:
              service: "registration"
              port: 8080
          - path: "/((assets|documentation)/.*)"
            pathType: "Prefix"
            backend:
              service: "assets"
              port: 8080
  portal:
    name: "portal"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-frontend"
      portaltag: 1.0.0-RC6
  registration:
    name: "registration"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-frontend-registration"
      registrationtag: 1.0.0-RC2
  assets:
    name: "assets"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-assets"
      assetstag: 1.0.0-RC4
  env:
    PORTAL_ASSETS_URL: ""
    PORTAL_BACKEND_URL: ""
    CENTRALIDP_URL: ""
    BPDM_API_URL: ""
    SEMANTICS_URL: ""

backend:
  ingress:
    enabled: false
    name: "portal-backend"
    annotations:
      kubernetes.io/ingress.class: "nginx"
      nginx.ingress.kubernetes.io/use-regex: "true"
      nginx.ingress.kubernetes.io/enable-cors: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: "8m"
      nginx.ingress.kubernetes.io/cors-allow-origin: ""
    tls:
      - secretName: ""
        hosts:
          - ""
    hosts:
      - host: ""
        paths:
          - path: "/api/registration"
            pathType: "Prefix"
            backend:
              service: "registration-service"
              port: 8080
          - path: "/api/administration"
            pathType: "Prefix"
            backend:
              service: "administration-service"
              port: 8080
          - path: "/api/notification"
            pathType: "Prefix"
            backend:
              service: "notification-service"
              port: 8080
          - path: "/api/provisioning"
            pathType: "Prefix"
            backend:
              service: "provisioning-service"
              port: 8080
          - path: "/api/apps"
            pathType: "Prefix"
            backend:
              service: "marketplace-app-service"
              port: 8080
          - path: "/api/services"
            pathType: "Prefix"
            backend:
              service: "services-service"
              port: 8080
  dbConnection:
    port: "5432"
    schema: "portal"
    sslMode: "Disable"
  basePortalAddress: ""
  keycloak:
    central:
      baseAddress: ""
      clientId: ""
      clientSecret: ""
      authRealm: "CX-Central"
      jwtBearerOptions:
        metadataAddress: ""
        tokenValidationParameters:
          validIssuer: ""
          validAudience: "Cl2-CX-Portal"
      dbConnection:
        host: "centralidp-postgresql-primary"
        port: "5432"
        user: "kccentral"
        database: "iamcentralidp"
        password: ""
        schema: "public"
        sslMode: "Disable"
    shared:
      baseAddress: ""
      clientId: ""
      clientSecret: ""
      authRealm: "master"
    secret: "secret-keycloak"
  mailing:
    host: ""
    port: ""
    user: ""
    password: ""
    secret: "secret-mailing"
  registration:
    name: "registration-service"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_registration-service"
      registrationservicetag: v1.0.0-RC6
    secret:
      name: "secret-registration"
      appsettings: ""
  administration:
    name: "administration-service"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_administration-service"
      administrationservicetag: v1.0.0-RC6
    secret:
      name: "secret-administration"
      appsettings: ""
  provisioning:
    centralRealm: "CX-Central"
    centralRealmId: "CX-Central"
    invitedUserInitialRoles:
      registration: "Company Admin"
    centralIdentityProvider:
      clientId: "central-idp"
    sharedRealmClient:
      clientId: "central-idp"
    sharedRealm:
      smtpServer:
        host: ""
        port: ""
        user: ""
        password: ""
        ssl: ""
        startTls: "true"
        auth: "true"
        from: ""
        replyTo: ""
        secret: "secret-mailing"
    service:
      name: "provisioning-service"
      image:
        name: "ghcr.io/catenax-ng/tx-portal-backend_provisioning-service"
        provisioningservicetag: v1.0.0-RC6
      debugEnabled: false
      swaggerEnabled: false
  appmarketplace:
    name: "marketplace-app-service"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_marketplace-app-service"
      appmarketplaceservicetag: v1.0.0-RC6
    secret:
      name: "secret-appmarketplace"
      appsettings: ""
  portalmigrations:
    name: "portal-migrations"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_portal-migrations"
      portalmigrationstag: v1.0.0-RC6
    seeding:
      testDataEnvironments: ""
  portalmaintenance:
    name: "portal-maintenance"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_maintenance-service"
      portalmaintenancetag: v1.0.0-RC6
  notification:
    name: "notification-service"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_notification-service"
      notificationservicetag: v1.0.0-RC6
    debugEnabled: false
    swaggerEnabled: false
  services:
    name: "services-service"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_services-service"
      servicesservicetag: v1.0.0-RC6
    secret:
      name: "secret-services"
      appsettings: ""
  provisioningmigrations:
    name: "provisioning-migrations"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_provisioning-migrations"
      provisioningmigrationstag: v1.0.0-RC6
  checklistworker:
    name: "checklist-worker"
    image:
      name: "ghcr.io/catenax-ng/tx-portal-backend_checklist-worker"
      checklistworkertag: v1.0.0-RC6
    secret: "secret-checklist-worker"
    logging:
      checklistLibrary: "Information"
      bpdmLibrary: "Information"
      clearinghouseLibrary: "Information"
      custodianLibrary: "Information"
      sdfactoryLibrary: "Information"
    applicationActivation:
      applicationApprovalInitialRoles:
        portal:
          role: "Company Admin"
        registration:
          role: "Company Admin"
      welcomeNotificationTypeIds:
        type0: "WELCOME"
        type1: "WELCOME_USE_CASES"
        type2: "WELCOME_SERVICE_PROVIDER"
        type3: "WELCOME_CONNECTOR_REGISTRATION"
        type4: "WELCOME_APP_MARKETPLACE"
    bpdm:
      baseAddress: ""
      tokenAddress: ""
      scope: "openid"
      grantType: "client_credentials"
      clientId: ""
      clientSecret: ""
    clearinghouse:
      baseAddress: ""
      tokenAddress: ""
      scope: "openid"
      grantType: "client_credentials"
      clientId: ""
      clientSecret: ""
    custodian:
      baseAddress: ""
      tokenAddress: ""
      scope: "openid"
      grantType: "client_credentials"
      clientId: ""
      clientSecret: ""
    sdfactory:
      baseAddress: ""
      tokenAddress: ""
      scope: "openid"
      grantType: "client_credentials"
      issuerBpn: ""
      clientId: ""
      clientSecret: ""
  placeholder: "empty"

postgresql:
  enabled: true
  fullnameOverride: "portal-backend-postgresql"
  auth:
    database: "postgres"
    existingSecret: "secret-postgres-init"
    password: ""
    replicationPassword: ""
    # custom users for cx portal
    portalUser: "portal"
    provisioningUser: "provisioning"
    portalPassword: ""
    provisioningPassword: ""
  architecture: "replication"
  audit:
    pgAuditLog: "write, ddl"
    logLinePrefix: "%m %u %d "
  primary:
    initdb:
      scriptsConfigMap: "configmap-postgres-init"
    extraEnvVars:
      - name: "PORTAL_PASSWORD"
        valueFrom:
          secretKeyRef:
            name: "{{ .Values.auth.existingSecret }}"
            key: "portal-password"
      - name: "PROVISIONING_PASSWORD"
        valueFrom:
          secretKeyRef:
            name: "{{ .Values.auth.existingSecret }}"
            key: "provisioning-password"

pgadmin4:
  enabled: false
  ingress:
    enabled: false
